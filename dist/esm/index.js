import e,{useRef as t,useState as n,useCallback as i,useEffect as o}from"react";!function(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===n&&i.firstChild?i.insertBefore(o,i.firstChild):i.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}("#magnifier{\n    image-rendering: auto;\n    width: 100%;\n    height: 100%;\n}");const c=(e,t)=>{const n={zoom:!1,box:{x:0,y:0,w:e.clientWidth/2,h:e.clientHeight/2},imageSrc:""},i=()=>{e&&t&&(t.clearRect(0,0,e.clientWidth,e.clientHeight),(()=>{const{box:i,imageSrc:o,zoom:c}=n;if(""!==o){const n=new Image;if(n.src=o,c){let o=i.x<i.w/2?0:i.x-i.w/2;i.x>e.clientWidth-i.w/2&&(o=e.clientWidth-i.w);let c=i.y<i.h/2?0:i.y-i.h/2;i.y>e.clientWidth-i.h/2&&(c=e.clientWidth-i.h);const r=Math.round(100*o/e.clientWidth),a=n.naturalWidth*r/100,h=Math.round(100*c/e.clientHeight),l=n.naturalHeight*h/100;t.drawImage(n,a,l,n.naturalWidth/2,n.naturalHeight/2,0,0,e.clientWidth,e.clientHeight)}else t.drawImage(n,0,0,e.clientWidth,e.clientHeight)}})(),requestAnimationFrame(i))};return{startZoom:()=>{t.clearRect(0,0,e.clientWidth,e.clientHeight),i()},moveBox:(e,t)=>{n.box=Object.assign(Object.assign({},n.box),{x:e,y:t})},setImage:e=>{n.imageSrc=e},activeZoom:()=>{n.zoom=!0},disableZoom:()=>{n.zoom=!1}}},r=({image:r,height:a,width:h,breakpoints:l})=>{const d=t(null),[s,m]=n(null),[u,g]=n(h),[f,x]=n(a),v=i((e=>{if(null!==d&&d.current){const t=d.current.getBoundingClientRect();return{x:Math.round(e.clientX-t.left),y:Math.round(e.clientY-t.top)}}return{x:0,y:0}}),[]);return o((()=>{if(null!==d&&d.current){const e=d.current.getContext("2d");if(e){const t=c(d.current,e);t.setImage(r),t.startZoom(),m(t)}}}),[r]),o((()=>{if(l){const t=[];for(const n in l)t.push(window.matchMedia(`(max-width: ${n}px)`));function e(e){if(e.matches){for(const t in l)if(e.media.includes(`${t}px`)){const{height:e,width:n}=l[Number(t)];g(n),x(e)}}else g(h),x(a)}return e(t[0]),t.forEach((t=>t.addEventListener("change",e))),()=>{t.forEach((t=>t.removeEventListener("change",e)))}}}),[]),e.createElement("canvas",{id:"magnifier",ref:d,width:u,height:f,onMouseMove:e=>{const{x:t,y:n}=v(e);null==s||s.moveBox(t,n)},onMouseEnter:()=>null==s?void 0:s.activeZoom(),onMouseLeave:()=>null==s?void 0:s.disableZoom()})};export{r as ReactMagnifier};
//# sourceMappingURL=index.js.map

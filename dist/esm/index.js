import t,{useRef as e,useState as n,useCallback as i,useEffect as a}from"react";!function(t,e){void 0===e&&(e={});var n=e.insertAt;if(t&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css","top"===n&&i.firstChild?i.insertBefore(a,i.firstChild):i.appendChild(a),a.styleSheet?a.styleSheet.cssText=t:a.appendChild(document.createTextNode(t))}}("#magnifier{\n    image-rendering: auto;\n    width: 100%;\n    height: 100%;\n}");const r=(t,e)=>{const n={zoom:!1,box:{x:0,y:0,w:t.clientWidth/2,h:t.clientHeight/2},imageSrc:""},i=()=>{t&&e&&(e.clearRect(0,0,t.clientWidth,t.clientHeight),(()=>{const{box:i,imageSrc:a,zoom:r}=n;if(""!==a){const n=new Image;if(n.src=a,r){var o=Math.min(t.clientWidth/n.naturalWidth,t.clientHeight/n.naturalHeight);let a=i.x<i.w/2?0:i.x-i.w/2;i.x>t.clientWidth-i.w/2&&(a=t.clientWidth-i.w);let r=i.y<i.h/2?0:i.y-i.h/2;i.y>t.clientWidth-i.h/2&&(r=t.clientWidth-i.h);const l=Math.round(100*a/t.clientWidth),d=n.naturalWidth*l/100,u=Math.round(100*r/t.clientHeight),s=n.naturalHeight*u/100;var h=t.clientWidth/2-n.naturalWidth/2*o,c=t.clientHeight/2-n.naturalHeight/2*o;e.drawImage(n,d,s,n.naturalWidth/2,n.naturalHeight/2,h,c,n.naturalWidth*o,n.naturalHeight*o)}else{o=Math.min(t.clientWidth/n.naturalWidth,t.clientHeight/n.naturalHeight);var l=t.clientWidth/2-n.naturalWidth/2*o,d=t.clientHeight/2-n.naturalHeight/2*o;e.drawImage(n,l,d,n.naturalWidth*o,n.naturalHeight*o)}}})(),requestAnimationFrame(i))};return{startZoom:()=>{e.clearRect(0,0,t.clientWidth,t.clientHeight),i()},moveBox:(t,e)=>{n.box={...n.box,x:t,y:e}},setImage:t=>{n.imageSrc=t},activeZoom:()=>{n.zoom=!0},disableZoom:()=>{n.zoom=!1}}},o=({image:o,height:h,width:c,breakpoints:l})=>{const d=e(null),[u,s]=n(null),[m,g]=n(c),[f,x]=n(h),W=i((t=>{if(null!==d&&d.current){const e=d.current.getBoundingClientRect();return{x:Math.round(t.clientX-e.left),y:Math.round(t.clientY-e.top)}}return{x:0,y:0}}),[]);return a((()=>{if(null!==d&&d.current){const t=d.current.getContext("2d");if(t){const e=r(d.current,t);e.setImage(o),e.startZoom(),s(e)}}}),[o]),a((()=>{if(l){const e=[];for(const n in l)e.push(window.matchMedia(`(max-width: ${n}px)`));function t(t){if(t.matches){for(const e in l)if(t.media.includes(`${e}px`)){const{height:t,width:n}=l[Number(e)];g(n),x(t)}}else g(c),x(h)}return t(e[0]),e.forEach((e=>e.addEventListener("change",t))),()=>{e.forEach((e=>e.removeEventListener("change",t)))}}}),[]),t.createElement("canvas",{id:"magnifier",ref:d,width:m,height:f,onMouseMove:t=>{const{x:e,y:n}=W(t);u?.moveBox(e,n)},onMouseEnter:()=>u?.activeZoom(),onMouseLeave:()=>u?.disableZoom()})};export{o as ReactMagnifier};
//# sourceMappingURL=index.js.map

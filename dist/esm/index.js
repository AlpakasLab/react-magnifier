import t,{useRef as e,useState as n,useCallback as i,useEffect as o}from"react";!function(t,e){void 0===e&&(e={});var n=e.insertAt;if(t&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===n&&i.firstChild?i.insertBefore(o,i.firstChild):i.appendChild(o),o.styleSheet?o.styleSheet.cssText=t:o.appendChild(document.createTextNode(t))}}("#magnifier{\n    image-rendering: auto;\n    width: 100%;\n    height: 100%;\n}");const a=(t,e)=>{const n={zoom:!1,box:{x:0,y:0,w:t.clientWidth/2,h:t.clientHeight/2},imageSrc:""},i=()=>{t&&e&&(e.clearRect(0,0,t.clientWidth,t.clientHeight),(()=>{const{box:i,imageSrc:o,zoom:a}=n;if(""!==o){const n=new Image;if(n.src=o,a){let o=i.x<i.w/2?0:i.x-i.w/2;i.x>t.clientWidth-i.w/2&&(o=t.clientWidth-i.w);let a=i.y<i.h/2?0:i.y-i.h/2;i.y>t.clientWidth-i.h/2&&(a=t.clientWidth-i.h);const r=Math.round(100*o/t.clientWidth),c=n.naturalWidth*r/100,h=Math.round(100*a/t.clientHeight),l=n.naturalHeight*h/100;e.drawImage(n,c,l,n.naturalWidth/2,n.naturalHeight/2,0,0,t.clientWidth,t.clientHeight)}else{var r=Math.min(t.clientWidth/n.naturalWidth,t.clientHeight/n.naturalHeight),c=t.clientWidth/2-n.naturalWidth/2*r,h=t.clientHeight/2-n.naturalHeight/2*r;e.drawImage(n,c,h,n.naturalWidth*r,n.naturalHeight*r)}}})(),requestAnimationFrame(i))};return{startZoom:()=>{e.clearRect(0,0,t.clientWidth,t.clientHeight),i()},moveBox:(t,e)=>{n.box={...n.box,x:t,y:e}},setImage:t=>{n.imageSrc=t},activeZoom:()=>{n.zoom=!0},disableZoom:()=>{n.zoom=!1}}},r=({image:r,height:c,width:h,breakpoints:l})=>{const d=e(null),[s,u]=n(null),[m,g]=n(h),[f,x]=n(c),W=i((t=>{if(null!==d&&d.current){const e=d.current.getBoundingClientRect();return{x:Math.round(t.clientX-e.left),y:Math.round(t.clientY-e.top)}}return{x:0,y:0}}),[]);return o((()=>{if(null!==d&&d.current){const t=d.current.getContext("2d");if(t){const e=a(d.current,t);e.setImage(r),e.startZoom(),u(e)}}}),[r]),o((()=>{if(l){const e=[];for(const n in l)e.push(window.matchMedia(`(max-width: ${n}px)`));function t(t){if(t.matches){for(const e in l)if(t.media.includes(`${e}px`)){const{height:t,width:n}=l[Number(e)];g(n),x(t)}}else g(h),x(c)}return t(e[0]),e.forEach((e=>e.addEventListener("change",t))),()=>{e.forEach((e=>e.removeEventListener("change",t)))}}}),[]),t.createElement("canvas",{id:"magnifier",ref:d,width:m,height:f,onMouseMove:t=>{const{x:e,y:n}=W(t);s?.moveBox(e,n)},onMouseEnter:()=>s?.activeZoom(),onMouseLeave:()=>s?.disableZoom()})};export{r as ReactMagnifier};
//# sourceMappingURL=index.js.map
